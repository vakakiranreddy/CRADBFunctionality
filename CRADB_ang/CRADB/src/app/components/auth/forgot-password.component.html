<div class="container-fluid vh-100">
  <div class="row h-100 g-0">
    <!-- Left Section -->
    <div class="col-lg-6 d-none d-lg-flex left-section align-items-center justify-content-center">
      <div class="exclamation-shape">
        <div class="exclamation-top"></div>
        <div class="exclamation-dot"></div>
      </div>
      <div class="position-relative" style="z-index: 3; max-width: 400px;">
        <div class="quote-icon rounded-circle d-flex align-items-center justify-content-center fw-bold mb-3">"</div>
        <div class="message text-dark mb-3">
          Reset your password<br>securely and easily!
        </div>
        <div class="cta-text">Try Kanini Workspace.</div>
      </div>
    </div>

    <!-- Right Section -->
    <div class="col-lg-6 right-section d-flex align-items-center justify-content-center p-4">
      <div class="w-100" style="max-width: 420px;">
        <div class="logo mb-5">
          <img src="https://d3qscgr6xsioh.cloudfront.net/QKP5fuMOT4Cz5bq6FZo1_b56a9e68a063b1f453c5e2e9f5f3d19e.png?format=webp" alt="Kanini Logo" class="img-fluid">
        </div>

        <h2 class="page-title mb-2">{{ otpSent ? 'Reset Password' : 'Forgot Password' }}</h2>
        <p class="subtitle text-muted mb-4">
          {{ otpSent ? 'Enter the OTP sent to your email and your new password' : 'Enter your email address and we\'ll send you an OTP' }}
        </p>

        <!-- Email Form (Step 1) -->
        <div *ngIf="!otpSent">
          <form [formGroup]="emailForm" (ngSubmit)="sendOtp()">
            <div class="mb-4">
              <label for="email" class="form-label">Email ID</label>
              <input 
                type="email" 
                class="form-control" 
                id="email" 
                formControlName="email"
                placeholder="name@kanini.com"
                [class.is-invalid]="emailForm.get('email')?.invalid && emailForm.get('email')?.touched">
              <div class="invalid-feedback" *ngIf="emailForm.get('email')?.invalid && emailForm.get('email')?.touched">
                <span *ngIf="emailForm.get('email')?.errors?.['required']">Email is required</span>
                <span *ngIf="emailForm.get('email')?.errors?.['email']">Invalid email format</span>
              </div>
            </div>

            <div class="alert alert-danger" *ngIf="errorMessage" role="alert">
              {{ errorMessage }}
            </div>

            <div class="alert alert-success" *ngIf="successMessage" role="alert">
              {{ successMessage }}
            </div>

            <button 
              type="submit" 
              class="btn btn-signin w-100 text-white mb-3" 
              [disabled]="emailForm.invalid || loading">
              {{ loading ? 'SENDING...' : 'SEND OTP' }}
            </button>
          </form>
        </div>

        <!-- Reset Form (Step 2) -->
        <div *ngIf="otpSent">
          <form [formGroup]="resetForm" (ngSubmit)="resetPassword()">
            <div class="mb-4">
              <label for="otp" class="form-label">OTP</label>
              <input 
                type="text" 
                class="form-control" 
                id="otp" 
                formControlName="otp"
                placeholder="Enter 6-digit OTP"
                maxlength="6"
                [class.is-invalid]="resetForm.get('otp')?.invalid && resetForm.get('otp')?.touched">
              <div class="invalid-feedback" *ngIf="resetForm.get('otp')?.invalid && resetForm.get('otp')?.touched">
                <span *ngIf="resetForm.get('otp')?.errors?.['required']">OTP is required</span>
              </div>
            </div>

            <div class="mb-4">
              <label for="newPassword" class="form-label">New Password</label>
              <input 
                type="password" 
                class="form-control" 
                id="newPassword" 
                formControlName="newPassword"
                placeholder="Enter new password"
                [class.is-invalid]="resetForm.get('newPassword')?.invalid && resetForm.get('newPassword')?.touched">
              <div class="invalid-feedback" *ngIf="resetForm.get('newPassword')?.invalid && resetForm.get('newPassword')?.touched">
                <span *ngIf="resetForm.get('newPassword')?.errors?.['required']">New password is required</span>
                <span *ngIf="resetForm.get('newPassword')?.errors?.['minlength']">Password must be at least 6 characters</span>
              </div>
            </div>

            <div class="alert alert-danger" *ngIf="errorMessage" role="alert">
              {{ errorMessage }}
            </div>

            <div class="alert alert-success" *ngIf="successMessage" role="alert">
              {{ successMessage }}
            </div>

            <button 
              type="submit" 
              class="btn btn-signin w-100 text-white mb-3" 
              [disabled]="resetForm.invalid || loading">
              {{ loading ? 'RESETTING...' : 'RESET PASSWORD' }}
            </button>
          </form>
        </div>

        <div class="text-center">
          <a href="#" (click)="goToLogin($event)" class="text-muted">Back to Sign In</a>
        </div>
      </div>
    </div>
  </div>
</div>
